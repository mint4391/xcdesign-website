<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
  />
  <title>个人视觉设计 | 周晓城</title>

  <link
    rel="icon"
    href="https://xcdesign-1306237972.cos.ap-guangzhou.myqcloud.com/favicon.png"
  />

  <!-- Fancybox -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css"
  />


  <style>
    :root {
      --bg: #20252c;
      --card: #2a3039;
      --accent: #007aff;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: var(--bg);
      color: #fff;
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    }

    /* ======================
       首页平铺布局
    ====================== */
    .container {
      max-width: 1200px;
      margin: 20px auto;
      padding: 0 15px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .media-item {
      background: var(--card);
      border-radius: 8px;
      overflow: hidden;
      cursor: zoom-in;
      transition: transform 0.35s ease;
    }

    /* Hover 微放大 */
    .media-item:hover {
      transform: scale(1.015);
      box-shadow: #000813ae 0 4px 15px;
      transition: transform 0.25s ease;
    }

    .media-item img,
    .media-item video {
      width: 100%;
      display: block;
    }

    /* 首页视频：像 GIF 一样，不可交互 */
    .media-item video {
      pointer-events: none;
    }

    /* ======================
       Fancybox 样式
    ====================== */

    .fancybox__content {
      background: transparent !important;
    }

    /* 1. 控件渐隐效果：当内容被缩放或拖动时，工具栏、信息栏和缩略图渐隐 */
    .fancybox__toolbar,
    .fancybox__infobar,
    .fancybox__thumbs {
      transition: opacity 0.3s ease, transform 0.3s ease;
    }

    .fancybox__container.is-scaling .fancybox__toolbar,
    .fancybox__container.is-scaling .fancybox__infobar,
    .fancybox__container.is-scaling .fancybox__thumbs,
    .fancybox__container.is-dragging .fancybox__toolbar,
    .fancybox__container.is-dragging .fancybox__infobar,
    .fancybox__container.is-dragging .fancybox__thumbs {
      opacity: 0;
      pointer-events: none; /* 阻止在渐隐状态下被点击 */
    }

    /* 2. 缩略图样式优化 */

    /* 缩略图容器 */
    .f-thumbs__slide {
      /* 默认未选中态的宽度为选中态的 60% */
      width: 60px !important; /* 假设选中态宽度为 100px，则未选中为 60px */
      border-radius: 8px;
      overflow: hidden;
      transition: all 0.3s ease;
      position: relative;
    }

    /* 缩略图图片 */
    .f-thumbs__slide__img {
      object-fit: cover !important; /* 默认使用 cover，以实现遮罩效果 */
      transition: all 0.3s ease;
    }

    /* 未选中态：25% 黑色遮罩 */
    .f-thumbs__slide:not(.is-nav-selected)::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.25);
      pointer-events: none;
      transition: background-color 0.3s ease;
      z-index: 1;
    }

    /* 悬浮态：黑色遮罩为 0，宽度不变 */
    .f-thumbs__slide:not(.is-nav-selected):hover::before {
      background-color: rgba(0, 0, 0, 0);
    }

    /* 选中态：白色边框，图片自适应在盒子内（object-fit: contain） */
    .f-thumbs__slide.is-nav-selected {
      width: 100px !important; /* 恢复为默认宽度（假设为 100px） */
      border: 3px solid white; /* 白色边框 */
      box-shadow: none !important; /* 移除旧的 box-shadow */
    }

    .f-thumbs__slide.is-nav-selected .f-thumbs__slide__img {
      object-fit: contain !important; /* 图片自适应 */
    }

    /* 调整 Fancybox 默认的缩略图列表宽度，以适应缩略图宽度的变化 */
    .fancybox__thumbs {
      --f-thumb-width: 100px; /* 设定选中态的宽度 */
      --f-thumb-height: 60px; /* 设定高度 */
    }

    /* ======================
       Fancybox 按钮样式优化：圆形按钮
    ====================== */

    /* ======================
       Fancybox 按钮样式优化：圆形按钮 (最终修正版)
    ====================== */

    /* 针对所有按钮容器，使用 !important 确保覆盖默认样式 */
    .fancybox__button {
      /* 强制变为圆形 */
      border-radius: 50% !important; 
      /* 强制设置尺寸和内边距 */
      width: 44px !important;
      height: 44px !important;
      padding: 0 !important;
      /* 确保内容居中 */
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      /* 确保背景和颜色 */
      background: rgba(34, 34, 34, 0.8) !important;
      color: #fff !important;
      /* 移除可能影响形状的阴影 */
      box-shadow: none !important;
    }

    /* 针对关闭按钮，确保覆盖 */
    .fancybox__button.fancybox__button--close {
      border-radius: 50% !important;
    }

    /* 针对悬浮和焦点状态，确保圆形不被破坏 */
    .fancybox__button:hover,
    .fancybox__button:focus {
      border-radius: 50% !important;
      background: rgba(34, 34, 34, 1) !important; /* 悬浮时颜色稍深 */
    }

    /* GIF-like Video */
    .v-container {
      display: flex;
      justify-content: center;
      align-items: center;
      max-height: 80vh;
    }

    .v-container video {
      max-height: 80vh;
      width: auto;
      max-width: 100%;
      object-fit: contain;
      pointer-events: none;
      background: #000;
    }

    /* 彻底移除原生视频控件 & PiP */
    video::-webkit-media-controls,
    video::-webkit-media-controls-panel,
    video::-webkit-media-controls-overlay-play-button {
      display: none !important;
    }

    video {
      outline: none;
    }

    footer {
      padding: 40px 0;
      text-align: center;
      font-size: 12px;
      color: #555;
    }
  </style>
</head>
<body>

<main class="container" id="gallery-root"></main>

<footer>© 周晓城 · All Rights Reserved</footer>

<script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js"></script>

<script>
  const cos =
    "https://xcdesign-1306237972.cos.ap-guangzhou.myqcloud.com/";
  const root = document.getElementById("gallery-root");

  const videoIds = [18, 21, 23, 31, 35, 40, 42];

  for (let i = 1; i <= 43; i++) {
    const isVideo = videoIds.includes(i);
    const a = document.createElement("a");
    a.className = "media-item";
    a.dataset.fancybox = "gallery";

    if (!isVideo) {
      a.href = `${cos}${i}.png`;
      a.innerHTML = `<img src="${cos}${i}.png" loading="lazy">`;
    } else {
      a.dataset.type = "html";
      a.dataset.thumb = `${cos}${i - 1}.png`;
      a.dataset.src = `
        <div class="v-container">
          <video
            src="${cos}${i}.mp4"
            autoplay
            loop
            muted
            playsinline
            disablepictureinpicture
            controlslist="nodownload nofullscreen noremoteplayback"
          ></video>
        </div>
      `;

      a.innerHTML = `
        <video
          src="${cos}${i}.mp4"
          autoplay
          loop
          muted
          playsinline
          disablepictureinpicture
          poster="${cos}${i - 1}.png"
        ></video>
      `;
    }

    root.appendChild(a);
  }

  Fancybox.bind("[data-fancybox='gallery']", {
    backdropColor: "auto",

    // 性能优化配置
    Image: {
      // 启用浏览器原生图片解码，减少主线程阻塞
      // 兼容性：Chrome 85+, Safari 14.1+
      decode: true,
      // 启用图片懒加载
      lazy: true,
    },

    Toolbar: {
      display: {
        left: ["infobar"],
        right: ["thumbs", "fullscreen", "close"]
      }
    },

    Thumbs: {
      autoStart: true
    },

    l10n: {
      COUNT: "{current} / {total}"
    },

    on: {
      // 优化视频播放逻辑，解决移动端自动播放限制问题
      done: (_, slide) => {
        const video = slide.$content?.querySelector("video");
        if (video) {
          // 尝试播放，并捕获错误（通常是移动端的播放限制）
          video.play().catch(error => {
            // 如果自动播放失败，则尝试静音播放（通常是移动端允许的）
            if (error.name === "NotAllowedError" || error.name === "AbortError") {
              video.muted = true;
              video.play().catch(() => {
                // 最终失败，可能需要用户交互
              });
            }
          });
        }
      },
      "Carousel.change": (fancybox) => {
        const video = fancybox.getSlide()?.$content?.querySelector("video");
        if (video) {
          // 尝试播放，并捕获错误
          video.play().catch(error => {
            if (error.name === "NotAllowedError" || error.name === "AbortError") {
              video.muted = true;
              video.play().catch(() => {});
            }
          });
        }
      }
    }
  });

  // ======================
  // 安全屏蔽：右键/控制台/控制台网络
  // ======================

  // 1. 屏蔽右键菜单 (contextmenu)
  document.addEventListener('contextmenu', function(e) {
    e.preventDefault();
  });

  // 2. 屏蔽控制台 (F12, Ctrl+Shift+I, Ctrl+Shift+J, etc.)
  // 这种方法只能阻止通过键盘快捷键打开，但仍然是必要的防御措施
  document.onkeydown = function(e) {
    // F12
    if (e.keyCode == 123) {
      return false;
    }
    // Ctrl+Shift+I (或 Cmd+Option+I)
    if (e.ctrlKey && e.shiftKey && e.keyCode == 73) {
      return false;
    }
    // Ctrl+Shift+J (或 Cmd+Option+J)
    if (e.ctrlKey && e.shiftKey && e.keyCode == 74) {
      return false;
    }
    // Ctrl+U (查看源代码)
    if (e.ctrlKey && e.keyCode == 85) {
      return false;
    }
  };

  // 3. 持续检测控制台状态并干扰 (隐蔽检测 + console.clear 干扰)
  (function() {
    let devtoolsOpen = false;

    // 核心干扰逻辑：清空本地缓存并关闭页面
    // 注意：此函数不应在循环中调用，只在检测到控制台打开时调用一次
    function aggressiveInterference() {
      // 1. 清空本地缓存 (LocalStorage 和 SessionStorage)
      try {
        localStorage.clear();
        sessionStorage.clear();
      } catch (e) {
        // 捕获可能因安全策略导致的错误
      }

      // 2. 尝试关闭当前页面
      window.close();

      // 3. 作为 window.close() 无效时的备用方案：重定向到空白页
      window.location.href = 'about:blank';
    }

    // 基于 toString 的隐蔽检测 (在 Chrome/Edge 中非常有效)
    const devtools = /./;
    devtools.toString = function() {
      // 仅设置状态，不立即执行干扰
      devtoolsOpen = true;
    };

    // 触发 toString 方法，如果控制台打开，则 devtools.toString 会被调用
    console.log('%c', devtools);

    // 辅助检测：基于窗口尺寸变化 (作为补充，但效果不如 toString)
    // 这种方法可以检测到控制台被停靠在窗口内的情况
    const threshold = 160; // 经验值，控制台打开时 innerWidth 会显著减小
    const checkSize = function() {
      if (window.outerWidth - window.innerWidth > threshold || window.outerHeight - window.innerHeight > threshold) {
        // 检测到控制台打开
        devtoolsOpen = true;
      } else {
        // 检测到控制台关闭
        devtoolsOpen = false;
      }
    };

    // 监听窗口大小变化
    window.addEventListener('resize', checkSize);
    // 首次加载时检查
    checkSize();

    // 持续检查循环：用于确保在 toString 或 checkSize 首次触发后，干扰逻辑能被执行
    let hasInterfered = false;
    (function checkLoop() {
      if (devtoolsOpen && !hasInterfered) {
        // 如果检测到控制台打开，且尚未干扰过
        hasInterfered = true;
        aggressiveInterference();
      } else {
        // 否则，继续检查
        setTimeout(checkLoop, 500);
      }
    })();
    
  })();

</script>

</body>
</html>
